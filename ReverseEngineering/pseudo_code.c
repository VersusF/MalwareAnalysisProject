#include<stdio.h>

int main(){
    int eax, ebx, ecx, edx, edi, esi;
    char al, bl, cl, dl;
    int varC, var14, var1C, var48, var38, var30, var3C, var8, var10, var1, var78, var74, var7C, var4C, var50, var18, var54, var24, var58, var28, var70, var68, var2C, var44, var5C;
    char var1;
    
    varC = 9;
    ebx = 0x0A;
    var14 = 0;
    eax = varC;
    eax -= 9;
    var1C = eax;    
    var48 = 0x183A;
    eax = var48;
    var14 = eax;
    var38 = 0x0F4648C59;
    var14 += 0x1FB4;
    var1C = 0x13A6;
    var1C += 0x4F66;
    eax = ebx;
    eax -= 0x0A;
    var30 = eax;
    var1C += 0x2C6F4;
    var14 += 0x101BADF;
    var3C = 0x12C2;
    var38--;
    eax = var3C;
    var14 -= eax;

    // STARTS A DO-WHILE
    do {
        // THE BODY
        var10 = 0; //loc_101F6CD, points to a strange address
        eax = var1C;
        edx = ebx;
        edx -= 9;
        eax -= edx;
        eax += var3C;
        int var20 = eax;
        // INNER WHILE
            // INNER CHECK
            edi = var3C;
            eax = 0x1E;
            edx = eax % ebx;
            eax = eax / ebx;
            edi += eax;
            while (edi < var20){
                // INNER BODY
                eax = var20;
                edx = var14;
                al = (edx + eax)*;   // <- THE STRANGE INSTRUCTION
                var1 = al;
                edx = var1;
                var78 = edx; 
                eax = var30;
                var74 = eax;
                ecx = 6;
                edx = 0x0AAAAAAAB;
                long long int tmp = eax * edx; // mul
                eax = tmp & 0xFFFFFFFF; // least 32 bits
                edx = tmp & 0xFFFFFFFF00000000; // upper 32 bits
                edx /= 4;
                var7C = edx;
                edi = edx;
                edi += var38;
                edx = edi;
                edx = edx & 0x0FF;
                edi = var78;
                edi = edi ^ edx;
                edx = edi;
                dl = edx & 0xFF; // take the real dl
                var1 = dl;
                eax = var20;
                edx = var14;
                cl = var1;
                *(edx + eax) = cl; // DANGEROUS ACCESS TO THE MEMORY
                var20--;

                // AGAIN INNER CHECK
                edi = var3C;
                eax = 0x1E;
                edx = eax % ebx;
                eax = eax / ebx;
                edi += eax;
            }

        // THE CHECK
        var8 = 0; // memory ref
        var30++;
        eax = ebx;
        eax -= 4;
    } while (var30 <= eax);

    var4C = 0; // A strange constant
    var50 = 0; // Another one
    esi = ebx;
    esi -= 0x0A;
    
    while(esi < 0x24880){
        eax = var10;
        al = esi;
        var1 = al;
        eax = var8;
        dl = var1;
        esi ++;
    }

    var18 = 0; // Another stange constant
    var54 = 0x10000000;
    eax = ebx;
    eax -= 0x0A;
    var24 = eax;

    do{
        eax = var24;
        edx = var50;
        ecx = var4C;
        cl = *(ecx+eax); // DANGEROUS ACCESS
        *(eax+edx) = cl;
        var24++;
        eax = 0x0A1C8;
    } while(eax > var24);

    var58 = 0;  // Stange constant
    var28 = 0x153;
    var70 = 0x11E000;
    eax = var18;
    eax = *eax;     // STANGE OPERATION
    var68 = eax;
    var28 += 0x2CB;
    eax = varC;
    eax -= 9;
    var2C = eax;
    var28 += 0x0BE2;

    eax = var8;
    eax -= var28;
    var44 = eax;
    edi = var18;
    eax = 0x50;
    edx = eax % ebx;
    eax = eax / ebx;
    edi += eax;
    edi += var2C;
    var5C = edi;
    eax = edi;
    ax = *(eax);    // 2 bytes
    var3E = ax;
    edi = var3E;
    eax = 0x28;
    edx = eax % ebx;
    eax = eax / ebx;
    ecx = eax;
    edi = edi * 2; // * 2^cl, con cl = al, un char
    int di = edi & 0xFFFF;
    var32 = di;



    return 0;
}

/*
idiv    ebx
mov     ecx, eax
shl     edi, cl
mov     [ebp+var_32], di
*/